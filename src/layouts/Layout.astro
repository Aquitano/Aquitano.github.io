---
import { SEO } from 'astro-seo';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import Loader from '../components/Loader.astro';
import ScrollToTop from '../components/ScrollToTop.astro';
import { ClientRouter } from 'astro:transitions';
import '@fontsource-variable/syne';
import '@fontsource-variable/roboto-slab';
import '@fontsource/young-serif';

import '../styles/global.css';

const defaultKeywords = [
    'Thomas Breindl',
    'Thomas',
    'Breindl',
    'Portfolio',
    'Portfolio of Thomas Breindl',
    'Portfolio von Thomas Breindl',
    'Aquitano',
    'Deutschland',
    'Germany',
];

export interface Props {
    title: string;
    SEO?: {
        title?: string;
        description?: string;
        openGraph?: {
            title?: string;
            type?: string;
            image?: string;
        };
        twitter?: {
            creator?: string;
        };
        extend?: {
            meta?: {
                keywords?: string[];
            };
        };
    };
    active: 'Home' | 'Ãœber mich' | 'Projekte' | 'Kontakt';
    location?: string;
}

const { title, SEO: SEOData, active, location } = Astro.props;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
        <meta name="generator" content={Astro.generator} />

        <SEO
            title={title || 'Thomas Breindl | Portfolio'}
            description={SEOData?.description || 'Herzlich Willkommen zu dem Portfolio von Thomas Breindl!'}
            openGraph={{
                basic: {
                    title: SEOData?.openGraph?.title || title || 'Thomas Breindl | Portfolio',
                    type: SEOData?.openGraph?.type || 'website',
                    image: SEOData?.openGraph?.image || '',
                },
            }}
            twitter={{
                creator: SEOData?.twitter?.creator || '@breindlthomas',
            }}
            extend={{
                meta: [
                    {
                        name: 'keywords',
                        content:
                            // Add all keywords here and separate them with a comma
                            SEOData?.extend?.meta?.keywords?.join(',')?.concat(',', defaultKeywords.join(',')) ||
                            defaultKeywords.join(','),
                    },
                ],
            }}
        />
    </head>
    <body class="overflow-x-hidden antialiased">
        <a href="#main-content" class="skip-link">Skip to main content</a>
        <Loader />
        <Header active={active} location={location} />
        <ScrollToTop />
        <ClientRouter />
        <main id="main-content" tabindex="-1">
            <slot />
        </main>
        <Footer />

        <style is:global>
            @view-transition {
                navigation: auto;
            }

            @font-face {
                font-family: Poppins;
                font-style: normal;
                font-weight: 400;
                src:
                    local(''),
                    url(/fonts/poppins-v15-latin-ext_latin_devanagari-regular.woff2) format('woff2'),
                    url(/fonts/poppins-v15-latin-ext_latin_devanagari-regular.woff) format('woff');
                font-display: swap;
            }
            @font-face {
                font-family: Poppins;
                font-style: normal;
                font-weight: 500;
                src:
                    local(''),
                    url(/fonts/poppins-v15-latin-ext_latin_devanagari-500.woff2) format('woff2'),
                    url(/fonts/poppins-v15-latin-ext_latin_devanagari-500.woff) format('woff');
                font-display: swap;
            }

            :root {
                --accent: 124, 58, 237;
                --accent-gradient: linear-gradient(45deg, rgb(var(--accent)), #da62c4 30%, white 60%);
                /* Theming */
                --page-bg-color: #faf5ef;
                --page-bg-overlay:
                    radial-gradient(1200px 600px at 15% 0%, rgba(255, 187, 120, 0.08), transparent 60%),
                    radial-gradient(1000px 500px at 85% 100%, rgba(255, 187, 120, 0.05), transparent 60%);
            }
            [data-theme='dark'] {
                --page-bg-color: #0a0a0a;
                --page-bg-overlay: none;
            }
            html {
                font-family: system-ui, sans-serif;
                overflow-x: hidden;
                overflow-y: auto;
                scrollbar-width: none;
                scroll-behavior: smooth;
            }

            body {
                background-image: url('/images/grainBlack.png');
                background-color: var(--page-bg-color);
            }
            code {
                font-family:
                    Menlo,
                    Monaco,
                    Lucida Console,
                    Liberation Mono,
                    DejaVu Sans Mono,
                    Bitstream Vera Sans Mono,
                    Courier New,
                    monospace;
            }
            * {
                box-sizing: border-box;
                font-variant-ligatures: none;
                /* Debugging */
                /* outline: 3px solid limegreen !important; */
            }

            section {
                position: relative;
                width: 100%;
            }
            .wrapper {
                width: 100%;
                padding: 0 14px;
            }
            @media (min-width: 768px) and (min-height: 620px) {
                .wrapper {
                    padding: 0 30px;
                }
            }
            @media (min-width: 1280px) {
                .wrapper {
                    position: relative;
                    padding: 0 40px;
                }
            }
            @media (min-width: 1480px) {
                .wrapper {
                    max-width: 1480px;
                    margin: 0 auto;
                }
            }
            @media (min-width: 1280px) {
                .scroll-container {
                    position: relative;
                    height: auto;
                    padding-bottom: 0;
                }
            }

            /* Default overrides */
            footer,
            header,
            main,
            menu,
            nav,
            section {
                display: block;
            }
            audio,
            canvas,
            progress,
            video {
                display: inline-block;
            }
            h1,
            h2,
            h3,
            h4,
            h5 {
                margin: 0;
            }
            hr {
                margin: 0;
                padding: 0;
                border: 0;
                box-sizing: content-box;
                height: 0;
                overflow: visible;
            }
            ul {
                margin: 0;
                padding: 0;
            }
            img {
                border-style: none;
            }
            button,
            input,
            select,
            textarea {
                font: inherit;
                margin: 0;
            }
            optgroup {
                font-weight: 700;
            }
            button,
            input,
            select {
                overflow: visible;
            }
            button,
            select {
                text-transform: none;
            }
            fieldset {
                border: 1px solid silver;
                margin: 0 2px;
                padding: 0.35em 0.625em 0.75em;
            }
            legend {
                box-sizing: border-box;
                color: inherit;
                display: table;
                max-width: 100%;
                padding: 0;
                white-space: normal;
            }
            textarea {
                overflow: auto;
            }

            /* Legacy fixed h1 size removed; fluid sizes defined later */

            /* Focus styles */
            :focus-visible {
                outline: 3px solid #ffbb78;
                outline-offset: 2px;
            }
            /* Remove outline only when not focus-visible */
            :focus:not(:focus-visible) {
                outline: none;
            }

            /* Reduced motion support */
            @media (prefers-reduced-motion: reduce) {
                *, *::before, *::after {
                    animation: none !important;
                    transition: none !important;
                    scroll-behavior: auto !important;
                }
            }

            /* Dark mode focus color tweak */
            [data-theme='dark'] :focus-visible {
                outline-color: #ffbb78;
            }

            h1,
            h1.large,
            h2,
            h3 {
                font-family: 'Helvetica Now Display DW', sans-serif;
                font-weight: 800;
                letter-spacing: -0.01em;
            }
            .h2 .header-light,
            .h2.header-light,
            h1 .header-light,
            h1.header-light,
            h1.large .header-light,
            h1.large.header-light,
            h2 .header-light,
            h2.header-light,
            h3 .header-light,
            h3.header-light {
                font-weight: 500;
                color: #54595f;
                letter-spacing: normal;
            }
            .h2 .header-dark,
            .h2.header-dark,
            h1 .header-dark,
            h1.header-dark,
            h1.large .header-dark,
            h1.large.header-dark,
            h2 .header-dark,
            h2.header-dark,
            h3 .header-dark,
            h3.header-dark {
                font-weight: 500;
                color: #0f141e;
                letter-spacing: normal;
            }
            .h5,
            h4,
            h5 {
                font-family: 'Helvetica Now Display DW', sans-serif;
            }
            h4 {
                font-weight: 800;
                letter-spacing: normal;
                color: #0f141e;
            }
            h4 .header-light,
            h4.header-light {
                font-weight: 500;
                letter-spacing: normal;
            }
            h4 .header-dark,
            h4.header-dark {
                font-weight: 500;
                color: #0f141e;
                letter-spacing: normal;
            }
            .h5,
            h5 {
                font-weight: 400;
                letter-spacing: 0.4em;
            }
            /* Legacy size block removed (now fluid) */
            h1 .icon,
            h1.large .icon {
                width: 26px;
                height: 26px;
            }
            h1 .icon svg,
            h1.large .icon svg {
                top: 0.0588em;
            }
            h1 .icon--on-right,
            h1.large .icon--on-right {
                margin-left: 10px;
            }
            /* Removed legacy responsive h1 sizing (fluid now) */
            /* Removed large breakpoint h1 sizing overrides */
            /* Legacy h2 static size removed */
            .h2 .icon,
            h2 .icon {
                width: 22px;
                height: 22px;
            }
            .h2 .icon svg,
            h2 .icon svg {
                top: 0.0714em;
            }
            .h2 .icon--on-right,
            h2 .icon--on-right {
                margin-left: 10px;
            }
            /* Removed legacy responsive h2 sizing */
            @media (min-width: 1280px) {
                .h2 a.special:after,
                .h2 a.with-icon:after,
                h2 a.special:after,
                h2 a.with-icon:after {
                    border-width: 3px;
                }
            }
            /* Legacy h3 static size removed */
            h3 em {
                font-weight: 500;
                color: #cfd0d2;
                margin: 0 0.625rem;
                font-style: normal;
            }
            @media (min-width: 1024px) {
                h3 em {
                    margin: 0 0.9375rem;
                }
            }
            h3 .icon {
                width: 16px;
                height: 16px;
            }
            h3 .icon svg {
                top: 0;
            }
            h3 .icon--on-right {
                margin-left: 10px;
            }
            /* Removed legacy responsive h3 sizing */
            @media (min-width: 1280px) {
                h3 a.special:after,
                h3 a.with-icon:after {
                    border-width: 2px;
                }
            }
            /* Legacy h4 static size removed */
            h4 .icon {
                width: 16px;
                height: 16px;
            }
            h4 .icon svg {
                top: 0.1111em;
            }
            h4 .icon--on-right {
                margin-left: 10px;
            }
            @media (min-width: 1280px) {
                h4 a.special:after,
                h4 a.with-icon:after {
                    border-width: 2px;
                }
            }
            /* Legacy h5 static size removed (fluid + utility now) */
            .h5 .icon,
            h5 .icon {
                width: 16px;
                height: 16px;
            }
            .h5 .icon svg,
            h5 .icon svg {
                top: 0.1333em;
            }
            .h5 .icon--on-right,
            h5 .icon--on-right {
                margin-left: 5px;
            }
            @media (min-width: 1280px) {
                .h5 a.special:after,
                .h5 a.with-icon:after,
                h5 a.special:after,
                h5 a.with-icon:after {
                    border-width: 1px;
                }
            }
            p + h5 {
                margin-top: 30px;
            }
            p + p {
                margin-top: 20px;
            }
            h1.large + h3 {
                margin-top: 10px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h1.large + h3 {
                    margin-top: 20px;
                }
            }
            h1.large + p {
                margin-top: 5px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h1.large + p {
                    margin-top: 25px;
                }
            }
            h1 + h3 {
                margin-top: 10px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h1 + h3 {
                    margin-top: 25px;
                }
            }
            h1 + h5 {
                margin-top: 20px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h1 + h5 {
                    margin-top: 30px;
                }
            }
            h1 + h4 {
                margin-top: 30px;
            }
            h1 + p {
                margin-top: 10px;
            }
            h2 + h4 {
                margin-top: 20px;
            }
            h3 + h3 {
                margin-top: 15px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h3 + h3 {
                    margin-top: 25px;
                }
            }
            h3 + h4 {
                margin-top: 20px;
            }
            h4 + h5 {
                margin-top: 20px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h4 + h5 {
                    margin-top: 30px;
                }
            }
            h3 + p {
                margin-top: 10px;
            }
            h5 + h1.large {
                margin-top: 0;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h5 + h1.large {
                    margin-top: 15px;
                }
            }
            h5 + h1 {
                margin-top: 5px;
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h5 + h1 {
                    margin-top: 5px;
                }
            }
            @media (min-width: 768px) and (min-height: 620px), (min-width: 1280px) {
                h5 + h2,
                i + h2 {
                    margin-top: 5px;
                }
            }
            h5 + h3 {
                margin-top: 5px;
            }
        </style>
        <style is:global>
            /* Typography refinement & fluid scale overrides */
            :root {
                /* Modular scale base 1rem, ratio 1.125 */
                --step--2: 0.790rem; /* 1 / 1.125^2 */
                --step--1: 0.889rem; /* 1 / 1.125 */
                --step-0: 1rem;      /* base */
                --step-1: 1.125rem;  /* * 1.125 */
                --step-2: 1.266rem;  /* * 1.125^2 */
                --step-3: 1.424rem;  /* ... */
                --step-4: 1.602rem;
                --step-5: 1.802rem;
                --step-6: 2.027rem;
                --step-7: 2.281rem;
                --step-8: 2.566rem;
            }

            /* Fluid clamps (mobile -> large desktop). Adjusted to keep within prior visual rhythm */
            h1, .h1, h1.large { font-size: clamp(2.2rem, 1.2rem + 3.2vw, 3.6rem); line-height: 1.08; }
            h2, .h2 { font-size: clamp(1.9rem, 1.1rem + 2.4vw, 2.8rem); line-height: 1.15; }
            h3 { font-size: clamp(1.5rem, 0.9rem + 1.6vw, 2.05rem); line-height: 1.2; }
            h4 { font-size: clamp(1.25rem, 0.85rem + 1.1vw, 1.6rem); line-height: 1.3; }
            h5, .h5 { font-size: clamp(0.95rem, 0.8rem + 0.4vw, 1.1rem); letter-spacing: 0.08em; }

            /* Use font steps for utility classes (optional future use) */
            .fs-step--1 { font-size: var(--step--1); }
            .fs-step-0 { font-size: var(--step-0); }
            .fs-step-1 { font-size: var(--step-1); }
            .fs-step-2 { font-size: var(--step-2); }
            .fs-step-3 { font-size: var(--step-3); }
            .fs-step-4 { font-size: var(--step-4); }
            .fs-step-5 { font-size: var(--step-5); }
            .fs-step-6 { font-size: var(--step-6); }

            /* Micro-interactions base (cards & interactive blocks) */
            .interactive-card, .interactive-surface { 
                transition: transform 180ms cubic-bezier(.4,0,.2,1), box-shadow 180ms cubic-bezier(.4,0,.2,1); 
                will-change: transform; 
            }
            .interactive-card:hover, .interactive-card:focus-visible,
            .interactive-surface:hover, .interactive-surface:focus-visible { 
                transform: translateY(-4px) scale(1.01); 
                box-shadow: 0 6px 24px -8px rgba(0,0,0,.35), 0 2px 8px -2px rgba(0,0,0,.25); 
            }
            @media (prefers-reduced-motion: reduce) {
                .interactive-card, .interactive-surface { transition: none !important; }
                .interactive-card:hover, .interactive-card:focus-visible,
                .interactive-surface:hover, .interactive-surface:focus-visible { transform: none !important; box-shadow: none !important; }
            }
        </style>
    </body>
</html>
